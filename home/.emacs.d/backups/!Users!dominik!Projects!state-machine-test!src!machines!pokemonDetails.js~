import { call } from 'stent/lib/helpers';
import { getSpeciesDetails } from 'api';

export default {
  state: { name: 'idle', data: {}, error: false },
  transitions: {
    idle: {
      fetch: function* (state, name) {
        yield 'loading';

        try {
          const data = yield call(getSpeciesDetails, name);
          yield this.success(data);
        } catch (e) {
          yield this.error();
        }
      },
    },
    loading: {
      success: (state, data) => ({
        name: 'idle',
        data,
        error: false,
      }),
      error: (state) => ({
        name: 'idle',
        error: true,
      }),
    },
  },
}
